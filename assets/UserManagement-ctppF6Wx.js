import{q as ye,o as we,h as be,a as N}from"./antd-Bkgtc1Na.js";import{d as Ce,f as c,c as xe,o as Ue,_ as f,$ as m,k as a,a0 as t,Y as r,Z as v,G as n,u as D,X as M,a4 as V,a6 as i,F as K,a3 as Ne}from"./vendor-DYmnM11n.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Le={class:"user-management"},Se={class:"page-header"},$e={class:"header-right"},Me={class:"filter-toolbar"},ze={class:"filter-row"},Ae={class:"user-table"},Fe={key:0},Ie={key:1,class:"text-placeholder"},Re={key:4,class:"action-buttons"},qe={key:0,class:"user-detail"},De={class:"detail-header"},Ve={class:"user-info"},Te={key:0},Be={key:1},Oe={class:"role-permissions"},Pe={class:"permission-list"},Ee=Ce({__name:"UserManagement",setup(Ge){const Q=c(!1),h=c(""),L=c(""),S=c(""),C=c(!1),z=c(!1),x=c(!1),o=c(null),T=c(),u=c({username:"",realName:"",email:"",phone:"",role:"",department:"",password:"",remark:""}),X={username:[{required:!0,message:"请输入用户名"},{min:3,max:20,message:"用户名长度为3-20个字符"}],realName:[{required:!0,message:"请输入真实姓名"}],email:[{required:!0,message:"请输入邮箱地址"},{type:"email",message:"请输入正确的邮箱格式"}],phone:[{required:!0,message:"请输入手机号码"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码"}],role:[{required:!0,message:"请选择用户角色"}],password:[{required:!0,message:"请输入初始密码"},{min:6,message:"密码长度不能少于6位"}]},y=c({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:l=>`共 ${l} 条记录`}),w=c([{id:"1",username:"admin",realName:"系统管理员",email:"admin@company.com",phone:"13800138000",role:"admin",department:"信息技术部",status:"active",createdAt:"2024-01-01 10:00:00",lastLogin:"2024-06-24 09:30:00",remark:"系统超级管理员账户"},{id:"2",username:"analyst01",realName:"张数据",email:"zhang@company.com",phone:"13800138001",role:"analyst",department:"数据分析部",status:"active",createdAt:"2024-02-15 14:30:00",lastLogin:"2024-06-23 16:45:00"},{id:"3",username:"sales01",realName:"李销售",email:"li@company.com",phone:"13800138002",role:"business",department:"销售部",status:"active",createdAt:"2024-03-01 09:15:00",lastLogin:"2024-06-24 08:20:00"},{id:"4",username:"viewer01",realName:"王观察",email:"wang@company.com",phone:"13800138003",role:"viewer",department:"战略规划部",status:"inactive",createdAt:"2024-04-10 11:20:00"}]),Y=[{title:"头像",key:"avatar",width:80,align:"center"},{title:"用户名",dataIndex:"username",key:"username",width:120},{title:"真实姓名",dataIndex:"realName",key:"realName",width:120},{title:"邮箱地址",dataIndex:"email",key:"email",width:200},{title:"角色",key:"role",width:120,align:"center"},{title:"部门",dataIndex:"department",key:"department",width:120},{title:"状态",key:"status",width:100,align:"center"},{title:"最后登录",key:"lastLogin",width:160},{title:"操作",key:"actions",width:200,fixed:"right"}],Z=xe(()=>{let l=w.value;if(h.value){const e=h.value.toLowerCase();l=l.filter(d=>d.username.toLowerCase().includes(e)||d.realName.toLowerCase().includes(e)||d.email.toLowerCase().includes(e))}return L.value&&(l=l.filter(e=>e.role===L.value)),S.value&&(l=l.filter(e=>e.status===S.value)),l}),B=l=>({admin:"red",analyst:"blue",business:"green",viewer:"orange"})[l]||"default",A=l=>({admin:"超级管理员",analyst:"数据分析师",business:"业务用户",viewer:"只读观察员"})[l]||l,j=l=>({admin:["用户管理","角色管理","系统设置","数据导出","所有数据访问"],analyst:["数据治理","高级搜索","数据导出","数据标注"],business:["资源库查询","图谱分析","需求匹配","收藏夹管理"],viewer:["仪表板查看","报告浏览"]})[l]||[],F=l=>new Date(l).toLocaleString("zh-CN"),H=()=>{x.value=!1,u.value={username:"",realName:"",email:"",phone:"",role:"",department:"",password:"",remark:""},C.value=!0},W=l=>{x.value=!0,u.value={username:l.username,realName:l.realName,email:l.email,phone:l.phone,role:l.role,department:l.department,password:"",remark:l.remark||""},o.value=l,C.value=!0},ee=async()=>{var l;try{if(await((l=T.value)==null?void 0:l.validate()),x.value){const e=w.value.findIndex(d=>{var g;return d.id===((g=o.value)==null?void 0:g.id)});e!==-1&&(w.value[e]={...w.value[e],...u.value}),N.success("用户更新成功")}else{const e={id:Date.now().toString(),...u.value,status:"active",createdAt:new Date().toLocaleString("zh-CN")};w.value.unshift(e),N.success("用户创建成功")}C.value=!1}catch(e){console.error("表单验证失败:",e)}},ae=()=>{C.value=!1},te=l=>{o.value=l,z.value=!0},le=l=>{N.success(`已重置用户 ${l.realName} 的密码`)},se=l=>{l.status=l.status==="active"?"inactive":"active",N.success(`已${l.status==="active"?"启用":"禁用"}用户 ${l.realName}`)},ne=l=>{const e=w.value.findIndex(d=>d.id===l.id);e!==-1&&(w.value.splice(e,1),N.success(`已删除用户 ${l.realName}`))},oe=()=>{y.value.current=1},ue=()=>{y.value.current=1},re=()=>{y.value.current=1},ie=()=>{h.value="",L.value="",S.value="",y.value.current=1},de=()=>{N.success("用户数据导出成功")},me=l=>{y.value={...y.value,...l}};return Ue(()=>{y.value.total=w.value.length}),(l,e)=>{const d=r("a-button"),g=r("a-input"),_=r("a-select-option"),I=r("a-select"),O=r("a-avatar"),P=r("a-tag"),E=r("a-badge"),R=r("a-menu-item"),ve=r("a-menu-divider"),pe=r("a-menu"),_e=r("a-dropdown"),ce=r("a-table"),b=r("a-form-item"),U=r("a-col"),q=r("a-row"),fe=r("a-input-password"),ge=r("a-textarea"),ke=r("a-form"),G=r("a-modal"),k=r("a-descriptions-item"),J=r("a-descriptions");return v(),f("div",Le,[m("div",Se,[e[14]||(e[14]=m("div",{class:"header-left"},[m("h1",{class:"page-title"},"用户管理"),m("p",{class:"page-description"},"管理系统用户账户、角色权限和访问控制")],-1)),m("div",$e,[a(d,{type:"primary",onClick:H},{icon:t(()=>[a(D(ye))]),default:t(()=>[e[13]||(e[13]=n(" 新增用户 "))]),_:1,__:[13]})])]),m("div",Me,[m("div",ze,[a(g,{value:h.value,"onUpdate:value":e[0]||(e[0]=s=>h.value=s),placeholder:"搜索用户名、姓名或邮箱",style:{width:"300px"},onInput:oe},{prefix:t(()=>[a(D(we))]),_:1},8,["value"]),a(I,{value:L.value,"onUpdate:value":e[1]||(e[1]=s=>L.value=s),placeholder:"选择角色",style:{width:"150px"},onChange:ue},{default:t(()=>[a(_,{value:""},{default:t(()=>e[15]||(e[15]=[n("全部角色")])),_:1,__:[15]}),a(_,{value:"admin"},{default:t(()=>e[16]||(e[16]=[n("超级管理员")])),_:1,__:[16]}),a(_,{value:"analyst"},{default:t(()=>e[17]||(e[17]=[n("数据分析师")])),_:1,__:[17]}),a(_,{value:"business"},{default:t(()=>e[18]||(e[18]=[n("业务用户")])),_:1,__:[18]}),a(_,{value:"viewer"},{default:t(()=>e[19]||(e[19]=[n("只读观察员")])),_:1,__:[19]})]),_:1},8,["value"]),a(I,{value:S.value,"onUpdate:value":e[2]||(e[2]=s=>S.value=s),placeholder:"选择状态",style:{width:"120px"},onChange:re},{default:t(()=>[a(_,{value:""},{default:t(()=>e[20]||(e[20]=[n("全部状态")])),_:1,__:[20]}),a(_,{value:"active"},{default:t(()=>e[21]||(e[21]=[n("启用")])),_:1,__:[21]}),a(_,{value:"inactive"},{default:t(()=>e[22]||(e[22]=[n("禁用")])),_:1,__:[22]})]),_:1},8,["value"]),a(d,{onClick:ie},{default:t(()=>e[23]||(e[23]=[n("重置")])),_:1,__:[23]}),a(d,{type:"primary",onClick:de},{default:t(()=>e[24]||(e[24]=[n("导出用户")])),_:1,__:[24]})])]),m("div",Ae,[a(ce,{columns:Y,"data-source":Z.value,pagination:y.value,loading:Q.value,"row-key":"id",onChange:me},{bodyCell:t(({column:s,record:p})=>[s.key==="avatar"?(v(),M(O,{key:0,size:40},{default:t(()=>[n(i(p.username.charAt(0).toUpperCase()),1)]),_:2},1024)):s.key==="role"?(v(),M(P,{key:1,color:B(p.role)},{default:t(()=>[n(i(A(p.role)),1)]),_:2},1032,["color"])):s.key==="status"?(v(),M(E,{key:2,status:p.status==="active"?"success":"error",text:p.status==="active"?"启用":"禁用"},null,8,["status","text"])):s.key==="lastLogin"?(v(),f(K,{key:3},[p.lastLogin?(v(),f("span",Fe,i(F(p.lastLogin)),1)):(v(),f("span",Ie,"从未登录"))],64)):s.key==="actions"?(v(),f("div",Re,[a(d,{type:"link",size:"small",onClick:$=>W(p)},{default:t(()=>e[25]||(e[25]=[n(" 编辑 ")])),_:2,__:[25]},1032,["onClick"]),a(d,{type:"link",size:"small",onClick:$=>te(p)},{default:t(()=>e[26]||(e[26]=[n(" 详情 ")])),_:2,__:[26]},1032,["onClick"]),a(_e,null,{overlay:t(()=>[a(pe,null,{default:t(()=>[a(R,{onClick:$=>le(p)},{default:t(()=>e[28]||(e[28]=[n(" 重置密码 ")])),_:2,__:[28]},1032,["onClick"]),a(R,{onClick:$=>se(p)},{default:t(()=>[n(i(p.status==="active"?"禁用":"启用"),1)]),_:2},1032,["onClick"]),a(ve),a(R,{danger:"",onClick:$=>ne(p)},{default:t(()=>e[29]||(e[29]=[n(" 删除用户 ")])),_:2,__:[29]},1032,["onClick"])]),_:2},1024)]),default:t(()=>[a(d,{type:"link",size:"small"},{default:t(()=>[e[27]||(e[27]=n(" 更多 ")),a(D(be))]),_:1,__:[27]})]),_:2},1024)])):V("",!0)]),_:1},8,["data-source","pagination","loading"])]),a(G,{open:C.value,"onUpdate:open":e[11]||(e[11]=s=>C.value=s),title:x.value?"编辑用户":"新增用户",width:"600px",onOk:ee,onCancel:ae},{default:t(()=>[a(ke,{ref_key:"userFormRef",ref:T,model:u.value,rules:X,layout:"vertical"},{default:t(()=>[a(q,{gutter:16},{default:t(()=>[a(U,{span:12},{default:t(()=>[a(b,{label:"用户名",name:"username"},{default:t(()=>[a(g,{value:u.value.username,"onUpdate:value":e[3]||(e[3]=s=>u.value.username=s),placeholder:"请输入用户名",disabled:x.value},null,8,["value","disabled"])]),_:1})]),_:1}),a(U,{span:12},{default:t(()=>[a(b,{label:"真实姓名",name:"realName"},{default:t(()=>[a(g,{value:u.value.realName,"onUpdate:value":e[4]||(e[4]=s=>u.value.realName=s),placeholder:"请输入真实姓名"},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(q,{gutter:16},{default:t(()=>[a(U,{span:12},{default:t(()=>[a(b,{label:"邮箱地址",name:"email"},{default:t(()=>[a(g,{value:u.value.email,"onUpdate:value":e[5]||(e[5]=s=>u.value.email=s),placeholder:"请输入邮箱地址"},null,8,["value"])]),_:1})]),_:1}),a(U,{span:12},{default:t(()=>[a(b,{label:"手机号码",name:"phone"},{default:t(()=>[a(g,{value:u.value.phone,"onUpdate:value":e[6]||(e[6]=s=>u.value.phone=s),placeholder:"请输入手机号码"},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(q,{gutter:16},{default:t(()=>[a(U,{span:12},{default:t(()=>[a(b,{label:"用户角色",name:"role"},{default:t(()=>[a(I,{value:u.value.role,"onUpdate:value":e[7]||(e[7]=s=>u.value.role=s),placeholder:"选择用户角色"},{default:t(()=>[a(_,{value:"admin"},{default:t(()=>e[30]||(e[30]=[n("超级管理员")])),_:1,__:[30]}),a(_,{value:"analyst"},{default:t(()=>e[31]||(e[31]=[n("数据分析师")])),_:1,__:[31]}),a(_,{value:"business"},{default:t(()=>e[32]||(e[32]=[n("业务用户")])),_:1,__:[32]}),a(_,{value:"viewer"},{default:t(()=>e[33]||(e[33]=[n("只读观察员")])),_:1,__:[33]})]),_:1},8,["value"])]),_:1})]),_:1}),a(U,{span:12},{default:t(()=>[a(b,{label:"部门",name:"department"},{default:t(()=>[a(g,{value:u.value.department,"onUpdate:value":e[8]||(e[8]=s=>u.value.department=s),placeholder:"请输入部门"},null,8,["value"])]),_:1})]),_:1})]),_:1}),x.value?V("",!0):(v(),M(b,{key:0,label:"初始密码",name:"password"},{default:t(()=>[a(fe,{value:u.value.password,"onUpdate:value":e[9]||(e[9]=s=>u.value.password=s),placeholder:"请输入初始密码"},null,8,["value"])]),_:1})),a(b,{label:"备注",name:"remark"},{default:t(()=>[a(ge,{value:u.value.remark,"onUpdate:value":e[10]||(e[10]=s=>u.value.remark=s),placeholder:"用户备注信息",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"]),a(G,{open:z.value,"onUpdate:open":e[12]||(e[12]=s=>z.value=s),title:"用户详情",width:"800px",footer:null},{default:t(()=>[o.value?(v(),f("div",qe,[m("div",De,[a(O,{size:60},{default:t(()=>[n(i(o.value.username.charAt(0).toUpperCase()),1)]),_:1}),m("div",Ve,[m("h3",null,i(o.value.realName),1),m("p",null,i(o.value.username)+" | "+i(A(o.value.role)),1)])]),a(J,{title:"基本信息",column:2},{default:t(()=>[a(k,{label:"用户名"},{default:t(()=>[n(i(o.value.username),1)]),_:1}),a(k,{label:"真实姓名"},{default:t(()=>[n(i(o.value.realName),1)]),_:1}),a(k,{label:"邮箱地址"},{default:t(()=>[n(i(o.value.email),1)]),_:1}),a(k,{label:"手机号码"},{default:t(()=>[n(i(o.value.phone),1)]),_:1}),a(k,{label:"部门"},{default:t(()=>[n(i(o.value.department),1)]),_:1}),a(k,{label:"创建时间"},{default:t(()=>[n(i(F(o.value.createdAt)),1)]),_:1}),a(k,{label:"最后登录"},{default:t(()=>[o.value.lastLogin?(v(),f("span",Te,i(F(o.value.lastLogin)),1)):(v(),f("span",Be,"从未登录"))]),_:1}),a(k,{label:"账户状态"},{default:t(()=>[a(E,{status:o.value.status==="active"?"success":"error",text:o.value.status==="active"?"启用":"禁用"},null,8,["status","text"])]),_:1})]),_:1}),a(J,{title:"权限信息",column:1},{default:t(()=>[a(k,{label:"角色权限"},{default:t(()=>[m("div",Oe,[a(P,{color:B(o.value.role)},{default:t(()=>[n(i(A(o.value.role)),1)]),_:1},8,["color"]),m("div",Pe,[(v(!0),f(K,null,Ne(j(o.value.role),s=>(v(),f("span",{key:s},i(s),1))),128))])])]),_:1})]),_:1})])):V("",!0)]),_:1},8,["open"])])}}}),Xe=he(Ee,[["__scopeId","data-v-5091ecc5"]]);export{Xe as default};
